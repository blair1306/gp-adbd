<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>trace.h source code [codebrowser/system/core/include/cutils/trace.h] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'codebrowser/system/core/include/cutils/trace.h'; var root_path = '../../../../..'; var data_path = '../../../../../../data';</script>
<script src='../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>codebrowser</a>/<a href='../../..'>system</a>/<a href='../..'>core</a>/<a href='..'>include</a>/<a href='./'>cutils</a>/<a href='trace.h.html'>trace.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * Copyright (C) 2012 The Android Open Source Project</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Licensed under the Apache License, Version 2.0 (the "License");</i></td></tr>
<tr><th id="5">5</th><td><i> * you may not use this file except in compliance with the License.</i></td></tr>
<tr><th id="6">6</th><td><i> * You may obtain a copy of the License at</i></td></tr>
<tr><th id="7">7</th><td><i> *</i></td></tr>
<tr><th id="8">8</th><td><i> *      <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></i></td></tr>
<tr><th id="9">9</th><td><i> *</i></td></tr>
<tr><th id="10">10</th><td><i> * Unless required by applicable law or agreed to in writing, software</i></td></tr>
<tr><th id="11">11</th><td><i> * distributed under the License is distributed on an "AS IS" BASIS,</i></td></tr>
<tr><th id="12">12</th><td><i> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i></td></tr>
<tr><th id="13">13</th><td><i> * See the License for the specific language governing permissions and</i></td></tr>
<tr><th id="14">14</th><td><i> * limitations under the License.</i></td></tr>
<tr><th id="15">15</th><td><i> */</i></td></tr>
<tr><th id="16">16</th><td></td></tr>
<tr><th id="17">17</th><td><u>#<span data-ppcond="17">ifndef</span> <span class="macro" data-ref="_M/_LIBS_CUTILS_TRACE_H">_LIBS_CUTILS_TRACE_H</span></u></td></tr>
<tr><th id="18">18</th><td><u>#define <dfn class="macro" id="_M/_LIBS_CUTILS_TRACE_H" data-ref="_M/_LIBS_CUTILS_TRACE_H">_LIBS_CUTILS_TRACE_H</dfn></u></td></tr>
<tr><th id="19">19</th><td></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="../../../../bionic/libc/include/inttypes.h.html">&lt;inttypes.h&gt;</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="../../../../bionic/libc/include/stdatomic.h.html">&lt;stdatomic.h&gt;</a></u></td></tr>
<tr><th id="22">22</th><td><u>#include &lt;stdbool.h&gt;</u></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="../../../../bionic/libc/include/stdint.h.html">&lt;stdint.h&gt;</a></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="../../../../bionic/libc/include/stdio.h.html">&lt;stdio.h&gt;</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../../../../bionic/libc/include/sys/cdefs.h.html">&lt;sys/cdefs.h&gt;</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../../../../bionic/libc/include/sys/types.h.html">&lt;sys/types.h&gt;</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../../../../bionic/libc/include/unistd.h.html">&lt;unistd.h&gt;</a></u></td></tr>
<tr><th id="28">28</th><td></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="compiler.h.html">&lt;cutils/compiler.h&gt;</a></u></td></tr>
<tr><th id="30">30</th><td></td></tr>
<tr><th id="31">31</th><td><a class="macro" href="../../../../bionic/libc/include/sys/cdefs.h.html#85" title="extern &quot;C&quot; {" data-ref="_M/__BEGIN_DECLS">__BEGIN_DECLS</a></td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td><i class="doc">/**</i></td></tr>
<tr><th id="34">34</th><td><i class="doc"> * The ATRACE_TAG macro can be defined before including this header to trace</i></td></tr>
<tr><th id="35">35</th><td><i class="doc"> * using one of the tags defined below.  It must be defined to one of the</i></td></tr>
<tr><th id="36">36</th><td><i class="doc"> * following ATRACE_TAG_* macros.  The trace tag is used to filter tracing in</i></td></tr>
<tr><th id="37">37</th><td><i class="doc"> * userland to avoid some of the runtime cost of tracing when it is not desired.</i></td></tr>
<tr><th id="38">38</th><td><i class="doc"> *</i></td></tr>
<tr><th id="39">39</th><td><i class="doc"> * Defining ATRACE_TAG to be ATRACE_TAG_ALWAYS will result in the tracing always</i></td></tr>
<tr><th id="40">40</th><td><i class="doc"> * being enabled - this should ONLY be done for debug code, as userland tracing</i></td></tr>
<tr><th id="41">41</th><td><i class="doc"> * has a performance cost even when the trace is not being recorded.  Defining</i></td></tr>
<tr><th id="42">42</th><td><i class="doc"> * ATRACE_TAG to be ATRACE_TAG_NEVER or leaving ATRACE_TAG undefined will result</i></td></tr>
<tr><th id="43">43</th><td><i class="doc"> * in the tracing always being disabled.</i></td></tr>
<tr><th id="44">44</th><td><i class="doc"> *</i></td></tr>
<tr><th id="45">45</th><td><i class="doc"> * ATRACE_TAG_HAL should be bitwise ORed with the relevant tags for tracing</i></td></tr>
<tr><th id="46">46</th><td><i class="doc"> * within a hardware module.  For example a camera hardware module would set:</i></td></tr>
<tr><th id="47">47</th><td><i class="doc"> * #define ATRACE_TAG  (ATRACE_TAG_CAMERA | ATRACE_TAG_HAL)</i></td></tr>
<tr><th id="48">48</th><td><i class="doc"> *</i></td></tr>
<tr><th id="49">49</th><td><i class="doc"> * Keep these in sync with frameworks/base/core/java/android/os/Trace.java.</i></td></tr>
<tr><th id="50">50</th><td><i class="doc"> */</i></td></tr>
<tr><th id="51">51</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_NEVER" data-ref="_M/ATRACE_TAG_NEVER">ATRACE_TAG_NEVER</dfn>            0       // This tag is never enabled.</u></td></tr>
<tr><th id="52">52</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_ALWAYS" data-ref="_M/ATRACE_TAG_ALWAYS">ATRACE_TAG_ALWAYS</dfn>           (1&lt;&lt;0)  // This tag is always enabled.</u></td></tr>
<tr><th id="53">53</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_GRAPHICS" data-ref="_M/ATRACE_TAG_GRAPHICS">ATRACE_TAG_GRAPHICS</dfn>         (1&lt;&lt;1)</u></td></tr>
<tr><th id="54">54</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_INPUT" data-ref="_M/ATRACE_TAG_INPUT">ATRACE_TAG_INPUT</dfn>            (1&lt;&lt;2)</u></td></tr>
<tr><th id="55">55</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_VIEW" data-ref="_M/ATRACE_TAG_VIEW">ATRACE_TAG_VIEW</dfn>             (1&lt;&lt;3)</u></td></tr>
<tr><th id="56">56</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_WEBVIEW" data-ref="_M/ATRACE_TAG_WEBVIEW">ATRACE_TAG_WEBVIEW</dfn>          (1&lt;&lt;4)</u></td></tr>
<tr><th id="57">57</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_WINDOW_MANAGER" data-ref="_M/ATRACE_TAG_WINDOW_MANAGER">ATRACE_TAG_WINDOW_MANAGER</dfn>   (1&lt;&lt;5)</u></td></tr>
<tr><th id="58">58</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_ACTIVITY_MANAGER" data-ref="_M/ATRACE_TAG_ACTIVITY_MANAGER">ATRACE_TAG_ACTIVITY_MANAGER</dfn> (1&lt;&lt;6)</u></td></tr>
<tr><th id="59">59</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_SYNC_MANAGER" data-ref="_M/ATRACE_TAG_SYNC_MANAGER">ATRACE_TAG_SYNC_MANAGER</dfn>     (1&lt;&lt;7)</u></td></tr>
<tr><th id="60">60</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_AUDIO" data-ref="_M/ATRACE_TAG_AUDIO">ATRACE_TAG_AUDIO</dfn>            (1&lt;&lt;8)</u></td></tr>
<tr><th id="61">61</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_VIDEO" data-ref="_M/ATRACE_TAG_VIDEO">ATRACE_TAG_VIDEO</dfn>            (1&lt;&lt;9)</u></td></tr>
<tr><th id="62">62</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_CAMERA" data-ref="_M/ATRACE_TAG_CAMERA">ATRACE_TAG_CAMERA</dfn>           (1&lt;&lt;10)</u></td></tr>
<tr><th id="63">63</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_HAL" data-ref="_M/ATRACE_TAG_HAL">ATRACE_TAG_HAL</dfn>              (1&lt;&lt;11)</u></td></tr>
<tr><th id="64">64</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_APP" data-ref="_M/ATRACE_TAG_APP">ATRACE_TAG_APP</dfn>              (1&lt;&lt;12)</u></td></tr>
<tr><th id="65">65</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_RESOURCES" data-ref="_M/ATRACE_TAG_RESOURCES">ATRACE_TAG_RESOURCES</dfn>        (1&lt;&lt;13)</u></td></tr>
<tr><th id="66">66</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_DALVIK" data-ref="_M/ATRACE_TAG_DALVIK">ATRACE_TAG_DALVIK</dfn>           (1&lt;&lt;14)</u></td></tr>
<tr><th id="67">67</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_RS" data-ref="_M/ATRACE_TAG_RS">ATRACE_TAG_RS</dfn>               (1&lt;&lt;15)</u></td></tr>
<tr><th id="68">68</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_BIONIC" data-ref="_M/ATRACE_TAG_BIONIC">ATRACE_TAG_BIONIC</dfn>           (1&lt;&lt;16)</u></td></tr>
<tr><th id="69">69</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_POWER" data-ref="_M/ATRACE_TAG_POWER">ATRACE_TAG_POWER</dfn>            (1&lt;&lt;17)</u></td></tr>
<tr><th id="70">70</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_PACKAGE_MANAGER" data-ref="_M/ATRACE_TAG_PACKAGE_MANAGER">ATRACE_TAG_PACKAGE_MANAGER</dfn>  (1&lt;&lt;18)</u></td></tr>
<tr><th id="71">71</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_SYSTEM_SERVER" data-ref="_M/ATRACE_TAG_SYSTEM_SERVER">ATRACE_TAG_SYSTEM_SERVER</dfn>    (1&lt;&lt;19)</u></td></tr>
<tr><th id="72">72</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_DATABASE" data-ref="_M/ATRACE_TAG_DATABASE">ATRACE_TAG_DATABASE</dfn>         (1&lt;&lt;20)</u></td></tr>
<tr><th id="73">73</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_LAST" data-ref="_M/ATRACE_TAG_LAST">ATRACE_TAG_LAST</dfn>             ATRACE_TAG_DATABASE</u></td></tr>
<tr><th id="74">74</th><td></td></tr>
<tr><th id="75">75</th><td><i>// Reserved for initialization.</i></td></tr>
<tr><th id="76">76</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_NOT_READY" data-ref="_M/ATRACE_TAG_NOT_READY">ATRACE_TAG_NOT_READY</dfn>        (1ULL&lt;&lt;63)</u></td></tr>
<tr><th id="77">77</th><td></td></tr>
<tr><th id="78">78</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG_VALID_MASK" data-ref="_M/ATRACE_TAG_VALID_MASK">ATRACE_TAG_VALID_MASK</dfn> ((ATRACE_TAG_LAST - 1) | ATRACE_TAG_LAST)</u></td></tr>
<tr><th id="79">79</th><td></td></tr>
<tr><th id="80">80</th><td><u>#<span data-ppcond="80">ifndef</span> <span class="macro" data-ref="_M/ATRACE_TAG">ATRACE_TAG</span></u></td></tr>
<tr><th id="81">81</th><td><u>#define <dfn class="macro" id="_M/ATRACE_TAG" data-ref="_M/ATRACE_TAG">ATRACE_TAG</dfn> ATRACE_TAG_NEVER</u></td></tr>
<tr><th id="82">82</th><td><u>#<span data-ppcond="80">elif</span> ATRACE_TAG &gt; ATRACE_TAG_VALID_MASK</u></td></tr>
<tr><th id="83">83</th><td><u>#error ATRACE_TAG must be defined to be one of the tags defined in cutils/trace.h</u></td></tr>
<tr><th id="84">84</th><td><u>#<span data-ppcond="80">endif</span></u></td></tr>
<tr><th id="85">85</th><td></td></tr>
<tr><th id="86">86</th><td><i class="doc">/**</i></td></tr>
<tr><th id="87">87</th><td><i class="doc"> * Opens the trace file for writing and reads the property for initial tags.</i></td></tr>
<tr><th id="88">88</th><td><i class="doc"> * The atrace.tags.enableflags property sets the tags to trace.</i></td></tr>
<tr><th id="89">89</th><td><i class="doc"> * This function should not be explicitly called, the first call to any normal</i></td></tr>
<tr><th id="90">90</th><td><i class="doc"> * trace function will cause it to be run safely.</i></td></tr>
<tr><th id="91">91</th><td><i class="doc"> */</i></td></tr>
<tr><th id="92">92</th><td><em>void</em> <dfn class="decl" id="atrace_setup" title='atrace_setup' data-ref="atrace_setup">atrace_setup</dfn>();</td></tr>
<tr><th id="93">93</th><td></td></tr>
<tr><th id="94">94</th><td><i class="doc">/**</i></td></tr>
<tr><th id="95">95</th><td><i class="doc"> * If tracing is ready, set atrace_enabled_tags to the system property</i></td></tr>
<tr><th id="96">96</th><td><i class="doc"> * debug.atrace.tags.enableflags. Can be used as a sysprop change callback.</i></td></tr>
<tr><th id="97">97</th><td><i class="doc"> */</i></td></tr>
<tr><th id="98">98</th><td><em>void</em> <dfn class="decl" id="atrace_update_tags" title='atrace_update_tags' data-ref="atrace_update_tags">atrace_update_tags</dfn>();</td></tr>
<tr><th id="99">99</th><td></td></tr>
<tr><th id="100">100</th><td><i class="doc">/**</i></td></tr>
<tr><th id="101">101</th><td><i class="doc"> * Set whether the process is debuggable.  By default the process is not</i></td></tr>
<tr><th id="102">102</th><td><i class="doc"> * considered debuggable.  If the process is not debuggable then application-</i></td></tr>
<tr><th id="103">103</th><td><i class="doc"> * level tracing is not allowed unless the ro.debuggable system property is</i></td></tr>
<tr><th id="104">104</th><td><i class="doc"> * set to '1'.</i></td></tr>
<tr><th id="105">105</th><td><i class="doc"> */</i></td></tr>
<tr><th id="106">106</th><td><em>void</em> <dfn class="decl" id="atrace_set_debuggable" title='atrace_set_debuggable' data-ref="atrace_set_debuggable">atrace_set_debuggable</dfn>(<span class="macro" title="bool" data-ref="_M/bool"><em>bool</em></span> <dfn class="local col1 decl" id="1debuggable" title='debuggable' data-type='bool' data-ref="1debuggable">debuggable</dfn>);</td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td><i class="doc">/**</i></td></tr>
<tr><th id="109">109</th><td><i class="doc"> * Set whether tracing is enabled for the current process.  This is used to</i></td></tr>
<tr><th id="110">110</th><td><i class="doc"> * prevent tracing within the Zygote process.</i></td></tr>
<tr><th id="111">111</th><td><i class="doc"> */</i></td></tr>
<tr><th id="112">112</th><td><em>void</em> <dfn class="decl" id="atrace_set_tracing_enabled" title='atrace_set_tracing_enabled' data-ref="atrace_set_tracing_enabled">atrace_set_tracing_enabled</dfn>(<span class="macro" title="bool" data-ref="_M/bool"><em>bool</em></span> <dfn class="local col2 decl" id="2enabled" title='enabled' data-type='bool' data-ref="2enabled">enabled</dfn>);</td></tr>
<tr><th id="113">113</th><td></td></tr>
<tr><th id="114">114</th><td><i class="doc">/**</i></td></tr>
<tr><th id="115">115</th><td><i class="doc"> * Flag indicating whether setup has been completed, initialized to 0.</i></td></tr>
<tr><th id="116">116</th><td><i class="doc"> * Nonzero indicates setup has completed.</i></td></tr>
<tr><th id="117">117</th><td><i class="doc"> * Note: This does NOT indicate whether or not setup was successful.</i></td></tr>
<tr><th id="118">118</th><td><i class="doc"> */</i></td></tr>
<tr><th id="119">119</th><td><b>extern</b> <a class="typedef" href="../../../../bionic/libc/include/stdatomic.h.html#atomic_bool" title='atomic_bool' data-type='_Atomic(bool)' data-ref="atomic_bool">atomic_bool</a> <dfn class="decl" id="atrace_is_ready" title='atrace_is_ready' data-ref="atrace_is_ready">atrace_is_ready</dfn>;</td></tr>
<tr><th id="120">120</th><td></td></tr>
<tr><th id="121">121</th><td><i class="doc">/**</i></td></tr>
<tr><th id="122">122</th><td><i class="doc"> * Set of ATRACE_TAG flags to trace for, initialized to ATRACE_TAG_NOT_READY.</i></td></tr>
<tr><th id="123">123</th><td><i class="doc"> * A value of zero indicates setup has failed.</i></td></tr>
<tr><th id="124">124</th><td><i class="doc"> * Any other nonzero value indicates setup has succeeded, and tracing is on.</i></td></tr>
<tr><th id="125">125</th><td><i class="doc"> */</i></td></tr>
<tr><th id="126">126</th><td><b>extern</b> <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="decl" id="atrace_enabled_tags" title='atrace_enabled_tags' data-ref="atrace_enabled_tags">atrace_enabled_tags</dfn>;</td></tr>
<tr><th id="127">127</th><td></td></tr>
<tr><th id="128">128</th><td><i class="doc">/**</i></td></tr>
<tr><th id="129">129</th><td><i class="doc"> * Handle to the kernel's trace buffer, initialized to -1.</i></td></tr>
<tr><th id="130">130</th><td><i class="doc"> * Any other value indicates setup has succeeded, and is a valid fd for tracing.</i></td></tr>
<tr><th id="131">131</th><td><i class="doc"> */</i></td></tr>
<tr><th id="132">132</th><td><b>extern</b> <em>int</em> <dfn class="decl" id="atrace_marker_fd" title='atrace_marker_fd' data-ref="atrace_marker_fd">atrace_marker_fd</dfn>;</td></tr>
<tr><th id="133">133</th><td></td></tr>
<tr><th id="134">134</th><td><i class="doc">/**</i></td></tr>
<tr><th id="135">135</th><td><i class="doc"> * atrace_init readies the process for tracing by opening the trace_marker file.</i></td></tr>
<tr><th id="136">136</th><td><i class="doc"> * Calling any trace function causes this to be run, so calling it is optional.</i></td></tr>
<tr><th id="137">137</th><td><i class="doc"> * This can be explicitly run to avoid setup delay on first trace function.</i></td></tr>
<tr><th id="138">138</th><td><i class="doc"> */</i></td></tr>
<tr><th id="139">139</th><td><u>#define <dfn class="macro" id="_M/ATRACE_INIT" data-ref="_M/ATRACE_INIT">ATRACE_INIT</dfn>() atrace_init()</u></td></tr>
<tr><th id="140">140</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="_Z11atrace_initv" title='atrace_init' data-ref="_Z11atrace_initv">atrace_init</dfn>()</td></tr>
<tr><th id="141">141</th><td>{</td></tr>
<tr><th id="142">142</th><td>    <b>if</b> (<a class="macro" href="compiler.h.html#26" title="(__builtin_expect( !!(!__c11_atomic_load(&amp;atrace_is_ready, memory_order_acquire)), false ))" data-ref="_M/CC_UNLIKELY">CC_UNLIKELY</a>(!<a class="macro" href="../../../../bionic/libc/include/stdatomic.h.html#423" title="__c11_atomic_load(&amp;atrace_is_ready, memory_order_acquire)" data-ref="_M/atomic_load_explicit">atomic_load_explicit</a>(&amp;<a class="ref" href="#atrace_is_ready" title='atrace_is_ready' data-ref="atrace_is_ready">atrace_is_ready</a>, <a class="enum" href="../../../../bionic/libc/include/stdatomic.h.html#memory_order_acquire" title='memory_order_acquire' data-ref="memory_order_acquire">memory_order_acquire</a>))) {</td></tr>
<tr><th id="143">143</th><td>        <a class="ref" href="#atrace_setup" title='atrace_setup' data-ref="atrace_setup">atrace_setup</a>();</td></tr>
<tr><th id="144">144</th><td>    }</td></tr>
<tr><th id="145">145</th><td>}</td></tr>
<tr><th id="146">146</th><td></td></tr>
<tr><th id="147">147</th><td><i class="doc">/**</i></td></tr>
<tr><th id="148">148</th><td><i class="doc"> * Get the mask of all tags currently enabled.</i></td></tr>
<tr><th id="149">149</th><td><i class="doc"> * It can be used as a guard condition around more expensive trace calculations.</i></td></tr>
<tr><th id="150">150</th><td><i class="doc"> * Every trace function calls this, which ensures atrace_init is run.</i></td></tr>
<tr><th id="151">151</th><td><i class="doc"> */</i></td></tr>
<tr><th id="152">152</th><td><u>#define <dfn class="macro" id="_M/ATRACE_GET_ENABLED_TAGS" data-ref="_M/ATRACE_GET_ENABLED_TAGS">ATRACE_GET_ENABLED_TAGS</dfn>() atrace_get_enabled_tags()</u></td></tr>
<tr><th id="153">153</th><td><em>static</em> <b>inline</b> <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="decl def" id="_Z23atrace_get_enabled_tagsv" title='atrace_get_enabled_tags' data-ref="_Z23atrace_get_enabled_tagsv">atrace_get_enabled_tags</dfn>()</td></tr>
<tr><th id="154">154</th><td>{</td></tr>
<tr><th id="155">155</th><td>    <a class="ref" href="#_Z11atrace_initv" title='atrace_init' data-ref="_Z11atrace_initv">atrace_init</a>();</td></tr>
<tr><th id="156">156</th><td>    <b>return</b> <a class="ref" href="#atrace_enabled_tags" title='atrace_enabled_tags' data-ref="atrace_enabled_tags">atrace_enabled_tags</a>;</td></tr>
<tr><th id="157">157</th><td>}</td></tr>
<tr><th id="158">158</th><td></td></tr>
<tr><th id="159">159</th><td><i class="doc">/**</i></td></tr>
<tr><th id="160">160</th><td><i class="doc"> * Test if a given tag is currently enabled.</i></td></tr>
<tr><th id="161">161</th><td><i class="doc"> * Returns nonzero if the tag is enabled, otherwise zero.</i></td></tr>
<tr><th id="162">162</th><td><i class="doc"> * It can be used as a guard condition around more expensive trace calculations.</i></td></tr>
<tr><th id="163">163</th><td><i class="doc"> */</i></td></tr>
<tr><th id="164">164</th><td><u>#define <dfn class="macro" id="_M/ATRACE_ENABLED" data-ref="_M/ATRACE_ENABLED">ATRACE_ENABLED</dfn>() atrace_is_tag_enabled(ATRACE_TAG)</u></td></tr>
<tr><th id="165">165</th><td><em>static</em> <b>inline</b> <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="decl def" id="_Z21atrace_is_tag_enabledm" title='atrace_is_tag_enabled' data-ref="_Z21atrace_is_tag_enabledm">atrace_is_tag_enabled</dfn>(<a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="local col3 decl" id="3tag" title='tag' data-type='uint64_t' data-ref="3tag">tag</dfn>)</td></tr>
<tr><th id="166">166</th><td>{</td></tr>
<tr><th id="167">167</th><td>    <b>return</b> <a class="ref" href="#_Z23atrace_get_enabled_tagsv" title='atrace_get_enabled_tags' data-ref="_Z23atrace_get_enabled_tagsv">atrace_get_enabled_tags</a>() &amp; <a class="local col3 ref" href="#3tag" title='tag' data-ref="3tag">tag</a>;</td></tr>
<tr><th id="168">168</th><td>}</td></tr>
<tr><th id="169">169</th><td></td></tr>
<tr><th id="170">170</th><td><i class="doc">/**</i></td></tr>
<tr><th id="171">171</th><td><i class="doc"> * Trace the beginning of a context.  name is used to identify the context.</i></td></tr>
<tr><th id="172">172</th><td><i class="doc"> * This is often used to time function execution.</i></td></tr>
<tr><th id="173">173</th><td><i class="doc"> */</i></td></tr>
<tr><th id="174">174</th><td><u>#define <dfn class="macro" id="_M/ATRACE_BEGIN" data-ref="_M/ATRACE_BEGIN">ATRACE_BEGIN</dfn>(name) atrace_begin(ATRACE_TAG, name)</u></td></tr>
<tr><th id="175">175</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="_Z12atrace_beginmPKc" title='atrace_begin' data-ref="_Z12atrace_beginmPKc">atrace_begin</dfn>(<a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="local col4 decl" id="4tag" title='tag' data-type='uint64_t' data-ref="4tag">tag</dfn>, <em>const</em> <em>char</em>* <dfn class="local col5 decl" id="5name" title='name' data-type='const char *' data-ref="5name">name</dfn>)</td></tr>
<tr><th id="176">176</th><td>{</td></tr>
<tr><th id="177">177</th><td>    <b>if</b> (<a class="macro" href="compiler.h.html#26" title="(__builtin_expect( !!(atrace_is_tag_enabled(tag)), false ))" data-ref="_M/CC_UNLIKELY">CC_UNLIKELY</a>(<a class="ref" href="#_Z21atrace_is_tag_enabledm" title='atrace_is_tag_enabled' data-ref="_Z21atrace_is_tag_enabledm">atrace_is_tag_enabled</a>(<a class="local col4 ref" href="#4tag" title='tag' data-ref="4tag">tag</a>))) {</td></tr>
<tr><th id="178">178</th><td>        <em>void</em> <dfn class="decl" id="atrace_begin_body" title='atrace_begin_body' data-ref="atrace_begin_body">atrace_begin_body</dfn>(<em>const</em> <em>char</em>*);</td></tr>
<tr><th id="179">179</th><td>        <a class="ref" href="#atrace_begin_body" title='atrace_begin_body' data-ref="atrace_begin_body">atrace_begin_body</a>(<a class="local col5 ref" href="#5name" title='name' data-ref="5name">name</a>);</td></tr>
<tr><th id="180">180</th><td>    }</td></tr>
<tr><th id="181">181</th><td>}</td></tr>
<tr><th id="182">182</th><td></td></tr>
<tr><th id="183">183</th><td><i class="doc">/**</i></td></tr>
<tr><th id="184">184</th><td><i class="doc"> * Trace the end of a context.</i></td></tr>
<tr><th id="185">185</th><td><i class="doc"> * This should match up (and occur after) a corresponding ATRACE_BEGIN.</i></td></tr>
<tr><th id="186">186</th><td><i class="doc"> */</i></td></tr>
<tr><th id="187">187</th><td><u>#define <dfn class="macro" id="_M/ATRACE_END" data-ref="_M/ATRACE_END">ATRACE_END</dfn>() atrace_end(ATRACE_TAG)</u></td></tr>
<tr><th id="188">188</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="_Z10atrace_endm" title='atrace_end' data-ref="_Z10atrace_endm">atrace_end</dfn>(<a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="local col6 decl" id="6tag" title='tag' data-type='uint64_t' data-ref="6tag">tag</dfn>)</td></tr>
<tr><th id="189">189</th><td>{</td></tr>
<tr><th id="190">190</th><td>    <b>if</b> (<a class="macro" href="compiler.h.html#26" title="(__builtin_expect( !!(atrace_is_tag_enabled(tag)), false ))" data-ref="_M/CC_UNLIKELY">CC_UNLIKELY</a>(<a class="ref" href="#_Z21atrace_is_tag_enabledm" title='atrace_is_tag_enabled' data-ref="_Z21atrace_is_tag_enabledm">atrace_is_tag_enabled</a>(<a class="local col6 ref" href="#6tag" title='tag' data-ref="6tag">tag</a>))) {</td></tr>
<tr><th id="191">191</th><td>        <em>char</em> <dfn class="local col7 decl" id="7c" title='c' data-type='char' data-ref="7c">c</dfn> = <kbd>'E'</kbd>;</td></tr>
<tr><th id="192">192</th><td>        <a class="ref" href="../../../../bionic/libc/include/unistd.h.html#write" title='write' data-ref="write">write</a>(<a class="ref" href="#atrace_marker_fd" title='atrace_marker_fd' data-ref="atrace_marker_fd">atrace_marker_fd</a>, &amp;<a class="local col7 ref" href="#7c" title='c' data-ref="7c">c</a>, <var>1</var>);</td></tr>
<tr><th id="193">193</th><td>    }</td></tr>
<tr><th id="194">194</th><td>}</td></tr>
<tr><th id="195">195</th><td></td></tr>
<tr><th id="196">196</th><td><i class="doc">/**</i></td></tr>
<tr><th id="197">197</th><td><i class="doc"> * Trace the beginning of an asynchronous event. Unlike ATRACE_BEGIN/ATRACE_END</i></td></tr>
<tr><th id="198">198</th><td><i class="doc"> * contexts, asynchronous events do not need to be nested. The name describes</i></td></tr>
<tr><th id="199">199</th><td><i class="doc"> * the event, and the cookie provides a unique identifier for distinguishing</i></td></tr>
<tr><th id="200">200</th><td><i class="doc"> * simultaneous events. The name and cookie used to begin an event must be</i></td></tr>
<tr><th id="201">201</th><td><i class="doc"> * used to end it.</i></td></tr>
<tr><th id="202">202</th><td><i class="doc"> */</i></td></tr>
<tr><th id="203">203</th><td><u>#define <dfn class="macro" id="_M/ATRACE_ASYNC_BEGIN" data-ref="_M/ATRACE_ASYNC_BEGIN">ATRACE_ASYNC_BEGIN</dfn>(name, cookie) \</u></td></tr>
<tr><th id="204">204</th><td><u>    atrace_async_begin(ATRACE_TAG, name, cookie)</u></td></tr>
<tr><th id="205">205</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="_Z18atrace_async_beginmPKci" title='atrace_async_begin' data-ref="_Z18atrace_async_beginmPKci">atrace_async_begin</dfn>(<a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="local col8 decl" id="8tag" title='tag' data-type='uint64_t' data-ref="8tag">tag</dfn>, <em>const</em> <em>char</em>* <dfn class="local col9 decl" id="9name" title='name' data-type='const char *' data-ref="9name">name</dfn>,</td></tr>
<tr><th id="206">206</th><td>        <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t">int32_t</a> <dfn class="local col0 decl" id="10cookie" title='cookie' data-type='int32_t' data-ref="10cookie">cookie</dfn>)</td></tr>
<tr><th id="207">207</th><td>{</td></tr>
<tr><th id="208">208</th><td>    <b>if</b> (<a class="macro" href="compiler.h.html#26" title="(__builtin_expect( !!(atrace_is_tag_enabled(tag)), false ))" data-ref="_M/CC_UNLIKELY">CC_UNLIKELY</a>(<a class="ref" href="#_Z21atrace_is_tag_enabledm" title='atrace_is_tag_enabled' data-ref="_Z21atrace_is_tag_enabledm">atrace_is_tag_enabled</a>(<a class="local col8 ref" href="#8tag" title='tag' data-ref="8tag">tag</a>))) {</td></tr>
<tr><th id="209">209</th><td>        <em>void</em> <dfn class="decl" id="atrace_async_begin_body" title='atrace_async_begin_body' data-ref="atrace_async_begin_body">atrace_async_begin_body</dfn>(<em>const</em> <em>char</em>*, <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t">int32_t</a>);</td></tr>
<tr><th id="210">210</th><td>        <a class="ref" href="#atrace_async_begin_body" title='atrace_async_begin_body' data-ref="atrace_async_begin_body">atrace_async_begin_body</a>(<a class="local col9 ref" href="#9name" title='name' data-ref="9name">name</a>, <a class="local col0 ref" href="#10cookie" title='cookie' data-ref="10cookie">cookie</a>);</td></tr>
<tr><th id="211">211</th><td>    }</td></tr>
<tr><th id="212">212</th><td>}</td></tr>
<tr><th id="213">213</th><td></td></tr>
<tr><th id="214">214</th><td><i class="doc">/**</i></td></tr>
<tr><th id="215">215</th><td><i class="doc"> * Trace the end of an asynchronous event.</i></td></tr>
<tr><th id="216">216</th><td><i class="doc"> * This should have a corresponding ATRACE_ASYNC_BEGIN.</i></td></tr>
<tr><th id="217">217</th><td><i class="doc"> */</i></td></tr>
<tr><th id="218">218</th><td><u>#define <dfn class="macro" id="_M/ATRACE_ASYNC_END" data-ref="_M/ATRACE_ASYNC_END">ATRACE_ASYNC_END</dfn>(name, cookie) atrace_async_end(ATRACE_TAG, name, cookie)</u></td></tr>
<tr><th id="219">219</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="_Z16atrace_async_endmPKci" title='atrace_async_end' data-ref="_Z16atrace_async_endmPKci">atrace_async_end</dfn>(<a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="local col1 decl" id="11tag" title='tag' data-type='uint64_t' data-ref="11tag">tag</dfn>, <em>const</em> <em>char</em>* <dfn class="local col2 decl" id="12name" title='name' data-type='const char *' data-ref="12name">name</dfn>, <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t">int32_t</a> <dfn class="local col3 decl" id="13cookie" title='cookie' data-type='int32_t' data-ref="13cookie">cookie</dfn>)</td></tr>
<tr><th id="220">220</th><td>{</td></tr>
<tr><th id="221">221</th><td>    <b>if</b> (<a class="macro" href="compiler.h.html#26" title="(__builtin_expect( !!(atrace_is_tag_enabled(tag)), false ))" data-ref="_M/CC_UNLIKELY">CC_UNLIKELY</a>(<a class="ref" href="#_Z21atrace_is_tag_enabledm" title='atrace_is_tag_enabled' data-ref="_Z21atrace_is_tag_enabledm">atrace_is_tag_enabled</a>(<a class="local col1 ref" href="#11tag" title='tag' data-ref="11tag">tag</a>))) {</td></tr>
<tr><th id="222">222</th><td>        <em>void</em> <dfn class="decl" id="atrace_async_end_body" title='atrace_async_end_body' data-ref="atrace_async_end_body">atrace_async_end_body</dfn>(<em>const</em> <em>char</em>*, <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t">int32_t</a>);</td></tr>
<tr><th id="223">223</th><td>        <a class="ref" href="#atrace_async_end_body" title='atrace_async_end_body' data-ref="atrace_async_end_body">atrace_async_end_body</a>(<a class="local col2 ref" href="#12name" title='name' data-ref="12name">name</a>, <a class="local col3 ref" href="#13cookie" title='cookie' data-ref="13cookie">cookie</a>);</td></tr>
<tr><th id="224">224</th><td>    }</td></tr>
<tr><th id="225">225</th><td>}</td></tr>
<tr><th id="226">226</th><td></td></tr>
<tr><th id="227">227</th><td><i class="doc">/**</i></td></tr>
<tr><th id="228">228</th><td><i class="doc"> * Traces an integer counter value.  name is used to identify the counter.</i></td></tr>
<tr><th id="229">229</th><td><i class="doc"> * This can be used to track how a value changes over time.</i></td></tr>
<tr><th id="230">230</th><td><i class="doc"> */</i></td></tr>
<tr><th id="231">231</th><td><u>#define <dfn class="macro" id="_M/ATRACE_INT" data-ref="_M/ATRACE_INT">ATRACE_INT</dfn>(name, value) atrace_int(ATRACE_TAG, name, value)</u></td></tr>
<tr><th id="232">232</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="_Z10atrace_intmPKci" title='atrace_int' data-ref="_Z10atrace_intmPKci">atrace_int</dfn>(<a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="local col4 decl" id="14tag" title='tag' data-type='uint64_t' data-ref="14tag">tag</dfn>, <em>const</em> <em>char</em>* <dfn class="local col5 decl" id="15name" title='name' data-type='const char *' data-ref="15name">name</dfn>, <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t">int32_t</a> <dfn class="local col6 decl" id="16value" title='value' data-type='int32_t' data-ref="16value">value</dfn>)</td></tr>
<tr><th id="233">233</th><td>{</td></tr>
<tr><th id="234">234</th><td>    <b>if</b> (<a class="macro" href="compiler.h.html#26" title="(__builtin_expect( !!(atrace_is_tag_enabled(tag)), false ))" data-ref="_M/CC_UNLIKELY">CC_UNLIKELY</a>(<a class="ref" href="#_Z21atrace_is_tag_enabledm" title='atrace_is_tag_enabled' data-ref="_Z21atrace_is_tag_enabledm">atrace_is_tag_enabled</a>(<a class="local col4 ref" href="#14tag" title='tag' data-ref="14tag">tag</a>))) {</td></tr>
<tr><th id="235">235</th><td>        <em>void</em> <dfn class="decl" id="atrace_int_body" title='atrace_int_body' data-ref="atrace_int_body">atrace_int_body</dfn>(<em>const</em> <em>char</em>*, <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t">int32_t</a>);</td></tr>
<tr><th id="236">236</th><td>        <a class="ref" href="#atrace_int_body" title='atrace_int_body' data-ref="atrace_int_body">atrace_int_body</a>(<a class="local col5 ref" href="#15name" title='name' data-ref="15name">name</a>, <a class="local col6 ref" href="#16value" title='value' data-ref="16value">value</a>);</td></tr>
<tr><th id="237">237</th><td>    }</td></tr>
<tr><th id="238">238</th><td>}</td></tr>
<tr><th id="239">239</th><td></td></tr>
<tr><th id="240">240</th><td><i class="doc">/**</i></td></tr>
<tr><th id="241">241</th><td><i class="doc"> * Traces a 64-bit integer counter value.  name is used to identify the</i></td></tr>
<tr><th id="242">242</th><td><i class="doc"> * counter. This can be used to track how a value changes over time.</i></td></tr>
<tr><th id="243">243</th><td><i class="doc"> */</i></td></tr>
<tr><th id="244">244</th><td><u>#define <dfn class="macro" id="_M/ATRACE_INT64" data-ref="_M/ATRACE_INT64">ATRACE_INT64</dfn>(name, value) atrace_int64(ATRACE_TAG, name, value)</u></td></tr>
<tr><th id="245">245</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="decl def" id="_Z12atrace_int64mPKcl" title='atrace_int64' data-ref="_Z12atrace_int64mPKcl">atrace_int64</dfn>(<a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t">uint64_t</a> <dfn class="local col7 decl" id="17tag" title='tag' data-type='uint64_t' data-ref="17tag">tag</dfn>, <em>const</em> <em>char</em>* <dfn class="local col8 decl" id="18name" title='name' data-type='const char *' data-ref="18name">name</dfn>, <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int64_t" title='int64_t' data-type='__int64_t' data-ref="int64_t">int64_t</a> <dfn class="local col9 decl" id="19value" title='value' data-type='int64_t' data-ref="19value">value</dfn>)</td></tr>
<tr><th id="246">246</th><td>{</td></tr>
<tr><th id="247">247</th><td>    <b>if</b> (<a class="macro" href="compiler.h.html#26" title="(__builtin_expect( !!(atrace_is_tag_enabled(tag)), false ))" data-ref="_M/CC_UNLIKELY">CC_UNLIKELY</a>(<a class="ref" href="#_Z21atrace_is_tag_enabledm" title='atrace_is_tag_enabled' data-ref="_Z21atrace_is_tag_enabledm">atrace_is_tag_enabled</a>(<a class="local col7 ref" href="#17tag" title='tag' data-ref="17tag">tag</a>))) {</td></tr>
<tr><th id="248">248</th><td>        <em>void</em> <dfn class="decl" id="atrace_int64_body" title='atrace_int64_body' data-ref="atrace_int64_body">atrace_int64_body</dfn>(<em>const</em> <em>char</em>*, <a class="typedef" href="../../../../bionic/libc/include/stdint.h.html#int64_t" title='int64_t' data-type='__int64_t' data-ref="int64_t">int64_t</a>);</td></tr>
<tr><th id="249">249</th><td>        <a class="ref" href="#atrace_int64_body" title='atrace_int64_body' data-ref="atrace_int64_body">atrace_int64_body</a>(<a class="local col8 ref" href="#18name" title='name' data-ref="18name">name</a>, <a class="local col9 ref" href="#19value" title='value' data-ref="19value">value</a>);</td></tr>
<tr><th id="250">250</th><td>    }</td></tr>
<tr><th id="251">251</th><td>}</td></tr>
<tr><th id="252">252</th><td></td></tr>
<tr><th id="253">253</th><td><a class="macro" href="../../../../bionic/libc/include/sys/cdefs.h.html#86" title="}" data-ref="_M/__END_DECLS">__END_DECLS</a></td></tr>
<tr><th id="254">254</th><td></td></tr>
<tr><th id="255">255</th><td><u>#<span data-ppcond="17">endif</span> // _LIBS_CUTILS_TRACE_H</u></td></tr>
<tr><th id="256">256</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='../../../../bionic/libc/bionic/bionic_systrace.cpp.html'>codebrowser/bionic/libc/bionic/bionic_systrace.cpp</a><br/>Generated on <em>2017-Sep-15</em> from project codebrowser<br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
